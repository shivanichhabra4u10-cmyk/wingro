"use strict";(self.webpackChunkwingrox_ai_client=self.webpackChunkwingrox_ai_client||[]).push([[572],{7572:(e,s,a)=>{a.r(s),a.d(s,{default:()=>n});var t=a(5043),l=a(6213),i=a(579);const r=l.A.create({baseURL:"http://localhost:3001/api/auth",headers:{"Content-Type":"application/json"}});r.interceptors.request.use(e=>{const s=localStorage.getItem("token");return s&&e.headers&&(e.headers.Authorization=`Bearer ${s}`),e},e=>Promise.reject(e));const n=()=>{const[e,s]=(0,t.useState)([]),[a,l]=(0,t.useState)(!0),[n,d]=(0,t.useState)(null),[c,o]=(0,t.useState)(null),[x,m]=(0,t.useState)(null),[h,u]=(0,t.useState)(null),[p,g]=(0,t.useState)(!1),[j,b]=(0,t.useState)(!1),[N,v]=(0,t.useState)(null),[y,f]=(0,t.useState)(null),[w,k]=(0,t.useState)(!1),[C,L]=(0,t.useState)(1),[S,_]=(0,t.useState)(10),[D,U]=(0,t.useState)(1),[M,z]=(0,t.useState)(0);return(0,t.useEffect)(()=>{(async()=>{try{l(!0);const e=await r.get(`/users?page=${C}&limit=${S}`);s(e.data.users||[]),U(e.data.totalPages||1),z(e.data.totalCount||0),d(null)}catch(e){console.error("Failed to fetch users:",e),d("Failed to load users. Please try again later.")}finally{l(!1)}})()},[C,S]),(0,i.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10",children:[(0,i.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"User Management"}),(0,i.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"View and manage users registered on the WinGroX AI platform."})]})}),n&&(0,i.jsx)("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 mb-6",children:(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsx)("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,i.jsx)("div",{className:"ml-3",children:(0,i.jsx)("p",{className:"text-sm text-red-700",children:n})})]})}),x&&(0,i.jsx)("div",{className:"bg-green-50 border-l-4 border-green-400 p-4 mb-6",children:(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsx)("svg",{className:"h-5 w-5 text-green-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.293 9.293a1 1 0 011.414 0L10 9.586l.293-.293a1 1 0 111.414 1.414L10 12.414l-1.707-1.707a1 1 0 010-1.414z",clipRule:"evenodd"})})}),(0,i.jsx)("div",{className:"ml-3",children:(0,i.jsx)("p",{className:"text-sm text-green-700",children:x})})]})}),a?(0,i.jsxs)("div",{className:"flex justify-center items-center h-64",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"}),(0,i.jsx)("span",{className:"ml-3 text-lg text-gray-700",children:"Loading users..."})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:0===e.length?(0,i.jsxs)("div",{className:"text-center py-12",children:[(0,i.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),(0,i.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No users found"}),(0,i.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"There are no users registered in the system."})]}):(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,i.jsx)("thead",{className:"bg-gray-50",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,i.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,i.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"}),(0,i.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Login"}),(0,i.jsx)("th",{scope:"col",className:"relative px-6 py-3",children:(0,i.jsx)("span",{className:"sr-only",children:"Actions"})})]})}),(0,i.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>{var a;return(0,i.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,i.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,i.jsx)("div",{className:"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-500 font-medium",children:(null===(a=e.name)||void 0===a?void 0:a.charAt(0).toUpperCase())||"U"})}),(0,i.jsxs)("div",{className:"ml-4",children:[(0,i.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,i.jsx)("div",{className:"text-sm text-gray-500",children:e.email})]})]})}),(0,i.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,i.jsxs)("select",{className:"px-2 py-1 text-xs rounded-full border focus:outline-none "+("admin"===e.role?"bg-purple-100 text-purple-800":"bg-green-100 text-green-800"),value:e.role,disabled:c===e._id,onChange:a=>(async(e,a)=>{o(e),m(null);try{await r.put("/users/role",{userId:e,role:a}),s(s=>s.map(s=>s._id===e?{...s,role:a}:s)),m("Role updated successfully.")}catch(t){d("Failed to update role.")}finally{o(null)}})(e._id,a.target.value),children:[(0,i.jsx)("option",{value:"user",children:"User"}),(0,i.jsx)("option",{value:"admin",children:"Admin"}),(0,i.jsx)("option",{value:"coach",children:"Coach"})]}),c===e._id&&(0,i.jsx)("span",{className:"ml-2 text-xs text-gray-500",children:"Updating..."})]}),(0,i.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,i.jsx)("div",{className:"text-sm text-gray-900",children:new Date(e.createdAt).toLocaleDateString()})}),(0,i.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,i.jsx)("div",{className:"text-sm text-gray-900",children:e.lastLogin?new Date(e.lastLogin).toLocaleDateString():"Never"})}),(0,i.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium flex gap-2 justify-end",children:[(0,i.jsx)("button",{className:"text-indigo-600 hover:text-indigo-900",onClick:()=>(e=>{u(e),g(!0)})(e),children:"View Details"}),(0,i.jsx)("button",{className:"text-blue-600 hover:text-blue-900",onClick:()=>(e=>{v(e),b(!0)})(e),children:"Edit"}),(0,i.jsx)("button",{className:"text-red-600 hover:text-red-900",onClick:()=>f(e._id),disabled:w&&y===e._id,children:w&&y===e._id?"Deleting...":"Delete"})]})]},e._id)})})]})})}),(0,i.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,i.jsxs)("div",{className:"text-sm text-gray-600",children:["Showing ",e.length?(C-1)*S+1:0," - ",Math.min(C*S,M)," of ",M," users"]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("button",{className:"px-3 py-1 rounded bg-gray-200 text-gray-700 disabled:opacity-50",onClick:()=>L(e=>Math.max(1,e-1)),disabled:1===C,children:"Previous"}),(0,i.jsxs)("span",{className:"px-2 py-1",children:["Page ",C," of ",D]}),(0,i.jsx)("button",{className:"px-3 py-1 rounded bg-gray-200 text-gray-700 disabled:opacity-50",onClick:()=>L(e=>Math.min(D,e+1)),disabled:C===D,children:"Next"}),(0,i.jsx)("select",{className:"ml-2 px-2 py-1 border rounded",value:S,onChange:e=>{_(Number(e.target.value)),L(1)},children:[10,20,50,100].map(e=>(0,i.jsxs)("option",{value:e,children:[e," / page"]},e))})]})]})]}),p&&h&&(0,i.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md relative",children:[(0,i.jsx)("button",{className:"absolute top-2 right-2 text-gray-400 hover:text-gray-700",onClick:()=>g(!1),children:"\xd7"}),(0,i.jsx)("h2",{className:"text-xl font-bold mb-4",children:"User Details"}),(0,i.jsxs)("div",{className:"mb-2",children:[(0,i.jsx)("span",{className:"font-semibold",children:"Name:"})," ",h.name]}),(0,i.jsxs)("div",{className:"mb-2",children:[(0,i.jsx)("span",{className:"font-semibold",children:"Email:"})," ",h.email]}),(0,i.jsxs)("div",{className:"mb-2",children:[(0,i.jsx)("span",{className:"font-semibold",children:"Role:"})," ",h.role]}),(0,i.jsxs)("div",{className:"mb-2",children:[(0,i.jsx)("span",{className:"font-semibold",children:"Joined:"})," ",new Date(h.createdAt).toLocaleString()]}),(0,i.jsxs)("div",{className:"mb-2",children:[(0,i.jsx)("span",{className:"font-semibold",children:"Last Login:"})," ",h.lastLogin?new Date(h.lastLogin).toLocaleString():"Never"]})]})}),j&&N&&(0,i.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md relative",children:[(0,i.jsx)("button",{className:"absolute top-2 right-2 text-gray-400 hover:text-gray-700",onClick:()=>b(!1),children:"\xd7"}),(0,i.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Edit User"}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),(0,i.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2",value:N.name,onChange:e=>v({...N,name:e.target.value})})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,i.jsx)("input",{type:"email",className:"w-full border rounded px-3 py-2",value:N.email,onChange:e=>v({...N,email:e.target.value})})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),(0,i.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:N.role,onChange:e=>v({...N,role:e.target.value}),children:[(0,i.jsx)("option",{value:"user",children:"User"}),(0,i.jsx)("option",{value:"admin",children:"Admin"}),(0,i.jsx)("option",{value:"coach",children:"Coach"})]})]}),(0,i.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,i.jsx)("button",{className:"px-4 py-2 bg-gray-200 rounded",onClick:()=>b(!1),children:"Cancel"}),(0,i.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",onClick:async()=>{if(N)try{await r.put(`users/${N._id}`,N),s(e=>e.map(e=>e._id===N._id?N:e)),m("User updated successfully."),b(!1)}catch(e){d("Failed to update user.")}},children:"Save"})]})]})}),y&&(0,i.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-sm relative",children:[(0,i.jsx)("h2",{className:"text-lg font-bold mb-4",children:"Delete User"}),(0,i.jsx)("p",{children:"Are you sure you want to delete this user? This action cannot be undone."}),(0,i.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,i.jsx)("button",{className:"px-4 py-2 bg-gray-200 rounded",onClick:()=>f(null),children:"Cancel"}),(0,i.jsx)("button",{className:"px-4 py-2 bg-red-600 text-white rounded",onClick:()=>(async e=>{k(!0);try{await r.delete(`users/${e}`),s(s=>s.filter(s=>s._id!==e)),m("User deleted successfully."),f(null)}catch(a){d("Failed to delete user.")}finally{k(!1)}})(y),disabled:w,children:w?"Deleting...":"Delete"})]})]})})]})}}}]);
//# sourceMappingURL=572.4480dd4d.chunk.js.map