"use strict";(self.webpackChunkwingrox_ai_client=self.webpackChunkwingrox_ai_client||[]).push([[98],{5098:(e,t,s)=>{s.r(t),s.d(t,{default:()=>n});var a=s(5043),i=s(579);const l=[{value:"pending",label:"Pending"},{value:"scheduled",label:"Scheduled"},{value:"completed",label:"Completed"},{value:"cancel",label:"Cancelled"}],n=()=>{const[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)(!0),[d,o]=(0,a.useState)(null),[r,c]=(0,a.useState)(""),[m,x]=(0,a.useState)(""),[h,p]=(0,a.useState)(""),[u,g]=(0,a.useState)(null),[b,w]=(0,a.useState)(!1),[f,j]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{n(!0),o(null);try{let e=`${"http://localhost:3001"}/api/bookings`;const s=[];r&&s.push(`coachId=${r}`),s.length&&(e+=`?${s.join("&")}`);const a=await fetch(e);if(!a.ok)throw new Error("Failed to fetch bookings");let i=(await a.json()).data;m&&(i=i.filter(e=>e.status===m)),h&&(i=i.filter(e=>e.date&&e.date.startsWith(h))),i.sort((e,t)=>{const s=new Date(e.createdAt);return new Date(t.createdAt).getTime()-s.getTime()}),t(i)}catch(e){o(e.message||"Error fetching bookings")}finally{n(!1)}})()},[r,m,h]);const N=Array.from(new Set(e.map(e=>`${e.coachId}|${e.coachName}`))).map(e=>{const[t,s]=e.split("|");return{id:t,name:s}});return(0,i.jsxs)("div",{className:"p-6 md:p-10 max-w-7xl mx-auto",children:[(0,i.jsx)("h1",{className:"text-4xl font-extrabold text-gray-900 mb-8 tracking-tight",children:"Bookings Management"}),(0,i.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6",children:[(0,i.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,i.jsx)("label",{className:"font-semibold text-gray-700",children:"Filter by Coach:"}),(0,i.jsxs)("select",{value:r,onChange:e=>c(e.target.value),className:"border border-gray-300 rounded-lg px-4 py-2 bg-white shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[(0,i.jsx)("option",{value:"",children:"All Coaches"}),N.map(e=>(0,i.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,i.jsx)("label",{className:"font-semibold text-gray-700 ml-4",children:"Status:"}),(0,i.jsxs)("select",{value:m,onChange:e=>x(e.target.value),className:"border border-gray-300 rounded-lg px-4 py-2 bg-white shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[(0,i.jsx)("option",{value:"",children:"All Statuses"}),l.map(e=>(0,i.jsx)("option",{value:e.value,children:e.label},e.value))]}),(0,i.jsx)("label",{className:"font-semibold text-gray-700 ml-4",children:"Date:"}),(0,i.jsx)("input",{type:"date",value:h,onChange:e=>p(e.target.value),className:"border border-gray-300 rounded-lg px-4 py-2 bg-white shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",style:{minWidth:140}})]}),(0,i.jsxs)("div",{className:"text-sm text-gray-500 mt-2 md:mt-0",children:["Total Bookings: ",(0,i.jsx)("span",{className:"font-bold text-indigo-600",children:e.length})]})]}),(0,i.jsx)("div",{className:"rounded-xl shadow-lg overflow-hidden border border-gray-200 bg-white max-w-full",children:(0,i.jsx)("div",{className:"overflow-x-auto w-full",children:s?(0,i.jsx)("div",{className:"p-8 text-center text-lg text-gray-500",children:"Loading bookings..."}):d?(0,i.jsx)("div",{className:"p-8 text-center text-red-600 font-semibold",children:d}):0===e.length?(0,i.jsx)("div",{className:"p-8 text-center text-gray-400",children:"No bookings found."}):(0,i.jsx)("div",{className:"w-full min-w-[900px]",children:(0,i.jsxs)("table",{className:"w-full text-sm md:text-base table-fixed",children:[(0,i.jsx)("thead",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 border-b border-gray-200",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"p-3 font-semibold text-left text-gray-700 whitespace-nowrap min-w-[110px]",children:"Coach"}),(0,i.jsx)("th",{className:"p-3 font-semibold text-left text-gray-700 whitespace-nowrap min-w-[110px]",children:"User Name"}),(0,i.jsx)("th",{className:"p-3 font-semibold text-left text-gray-700 whitespace-nowrap min-w-[220px]",children:"User Email"}),(0,i.jsx)("th",{className:"p-3 font-semibold text-left text-gray-700 whitespace-nowrap min-w-[100px]",children:"Date"}),(0,i.jsx)("th",{className:"p-3 font-semibold text-left text-gray-700 whitespace-nowrap min-w-[60px]",children:"Time"}),(0,i.jsx)("th",{className:"p-3 font-semibold text-left text-gray-700 whitespace-nowrap min-w-[70px]",children:"Duration"}),(0,i.jsx)("th",{className:"p-3 font-semibold text-left text-gray-700 whitespace-nowrap min-w-[70px]",children:"Mode"}),(0,i.jsx)("th",{className:"p-3 font-semibold text-left text-gray-700 whitespace-nowrap min-w-[80px]",children:"Status"}),(0,i.jsx)("th",{className:"p-3 font-semibold text-left text-gray-700 whitespace-nowrap min-w-[90px]",children:"Created"}),(0,i.jsx)("th",{className:"p-3 font-semibold text-left text-gray-700 whitespace-nowrap min-w-[80px]",children:"Action"})]})}),(0,i.jsx)("tbody",{className:"divide-y divide-gray-100",children:e.map(e=>(0,i.jsxs)("tr",{className:"hover:bg-indigo-50 transition-colors",children:[(0,i.jsx)("td",{className:"p-3 font-medium text-gray-900 whitespace-nowrap min-w-[110px]",children:e.coachName}),(0,i.jsx)("td",{className:"p-3 text-gray-800 whitespace-nowrap min-w-[110px]",children:e.userName}),(0,i.jsx)("td",{className:"p-3 text-indigo-700 whitespace-nowrap min-w-[220px] max-w-[240px] overflow-hidden text-ellipsis",title:e.userEmail,children:e.userEmail}),(0,i.jsx)("td",{className:"p-3 whitespace-nowrap text-indigo-600 font-semibold min-w-[100px]",children:e.date?new Date(e.date).toLocaleDateString():""}),(0,i.jsx)("td",{className:"p-3 whitespace-nowrap min-w-[60px]",children:e.time}),(0,i.jsxs)("td",{className:"p-3 whitespace-nowrap min-w-[70px]",children:[e.duration," min"]}),(0,i.jsx)("td",{className:"p-3 whitespace-nowrap capitalize min-w-[70px]",children:e.sessionType}),(0,i.jsx)("td",{className:"p-3 whitespace-nowrap min-w-[80px]",children:(0,i.jsx)("span",{className:"inline-block px-2 py-1 rounded text-xs font-semibold align-middle "+("pending"!==e.status&&e.status?"completed"===e.status?"bg-green-100 text-green-700":"scheduled"===e.status?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600":"bg-yellow-100 text-yellow-800"),children:e.status?e.status.charAt(0).toUpperCase()+e.status.slice(1):"Pending"})}),(0,i.jsx)("td",{className:"p-3 whitespace-nowrap text-xs text-gray-500 min-w-[90px]",children:e.createdAt?new Date(e.createdAt).toLocaleDateString():""}),(0,i.jsx)("td",{className:"p-3 whitespace-nowrap min-w-[80px] text-center",children:(0,i.jsx)("button",{className:"px-3 py-1 bg-indigo-600 text-white rounded hover:bg-indigo-700 text-xs font-semibold shadow focus:outline-none focus:ring-2 focus:ring-indigo-400",onClick:()=>g(e),tabIndex:0,"aria-label":`View booking for ${e.userName}`,children:"View"})})]},e._id))})]})})})}),u&&(0,i.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:(0,i.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl max-w-lg w-full p-8 relative animate-fadeIn",children:[(0,i.jsx)("button",{className:"absolute top-4 right-4 text-gray-400 hover:text-gray-700",onClick:()=>g(null),"aria-label":"Close",children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,i.jsx)("h2",{className:"text-2xl font-bold mb-4 text-indigo-700",children:"Booking Details"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-2 mb-4 text-sm",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-semibold",children:"Coach:"})," ",u.coachName]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-semibold",children:"User:"})," ",u.userName," (",u.userEmail,")"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-semibold",children:"Phone:"})," ",u.phoneNumber||"-"]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-semibold",children:"Topic:"})," ",u.topic]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-semibold",children:"Date/Time:"})," ",u.date?new Date(u.date).toLocaleDateString():""," ",u.time]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-semibold",children:"Duration/Type:"})," ",u.duration," min, ",u.sessionType]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-semibold",children:"User Notes:"})," ",(0,i.jsx)("span",{className:"whitespace-pre-line text-gray-700",children:u.notes||(0,i.jsx)("span",{className:"italic text-gray-400",children:"(none)"})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-semibold",children:"Created:"})," ",u.createdAt?new Date(u.createdAt).toLocaleDateString():""]})]}),(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),w(!0),j(null);const s=e.target,a=s.status.value,i=s.meetingLink?s.meetingLink.value:u.meetingLink,l=s.date.value,n=s.time.value,d=s.adminComments?s.adminComments.value:u.adminComments;if("scheduled"===a&&(!i||""===i.trim()))return j("Meeting link is required when status is Scheduled."),void w(!1);try{const e="http://localhost:3001";if(!(await fetch(`${e}/api/bookings/${u._id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:a,meetingLink:i,date:l,time:n,adminComments:d})})).ok)throw new Error("Failed to update booking");t(e=>e.map(e=>e._id===u._id?{...e,status:a,meetingLink:i,date:l,time:n,adminComments:d}:e)),g(e=>e?{...e,status:a,meetingLink:i,date:l,time:n,adminComments:d}:e)}catch(o){j(o.message||"Error updating booking")}finally{w(!1)}},children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block font-semibold mb-1",children:"Status:"}),(0,i.jsx)("select",{name:"status",defaultValue:u.status,className:"border rounded px-3 py-2 w-full max-w-[140px]",disabled:b,children:l.map(e=>(0,i.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block font-semibold mb-1",children:"Date:"}),(0,i.jsx)("input",{type:"date",name:"date",defaultValue:u.date?u.date.split("T")[0]:"",className:"border rounded px-3 py-2 w-full min-w-[180px] max-w-full",disabled:b,required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block font-semibold mb-1",children:"Time:"}),(0,i.jsx)("input",{type:"time",name:"time",defaultValue:u.time,className:"border rounded px-3 py-2 w-full",disabled:b,required:!0})]})]})]}),(0,i.jsxs)("div",{className:"mb-3",children:[(0,i.jsx)("label",{className:"block font-semibold mb-1",children:"Meeting Link:"}),(0,i.jsx)("input",{type:"url",name:"meetingLink",defaultValue:u.meetingLink||"",className:"border rounded px-3 py-2 w-full",placeholder:"https://...",disabled:b,required:"scheduled"===u.status})]}),(0,i.jsxs)("div",{className:"mb-3",children:[(0,i.jsx)("label",{className:"block font-semibold mb-1",children:"Admin Comments:"}),(0,i.jsx)("textarea",{name:"adminComments",defaultValue:u.adminComments||"",className:"border rounded px-3 py-2 w-full min-h-[60px]",placeholder:"Add internal admin comments...",disabled:b})]}),f&&(0,i.jsx)("div",{className:"text-red-600 mb-2",children:f})]}),(0,i.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,i.jsx)("button",{className:"px-5 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 font-semibold shadow",type:"button",disabled:b,onClick:()=>{const e=document.querySelector("form");e&&e.requestSubmit()},children:b?"Updating...":"Update"}),(0,i.jsx)("button",{className:"px-5 py-2 bg-red-600 text-white rounded hover:bg-red-700 font-semibold shadow",onClick:async()=>{if(window.confirm("Are you sure you want to delete this booking? This action cannot be undone.")){w(!0),j(null);try{const e="http://localhost:3001";if(!(await fetch(`${e}/api/bookings/${u._id}`,{method:"DELETE"})).ok)throw new Error("Failed to delete booking");t(e=>e.filter(e=>e._id!==u._id)),g(null)}catch(e){j(e.message||"Error deleting booking")}finally{w(!1)}}},disabled:b,children:"Delete"})]})]})})]})}}}]);
//# sourceMappingURL=98.8bd8b9eb.chunk.js.map