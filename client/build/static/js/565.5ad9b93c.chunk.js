"use strict";(self.webpackChunkwingrox_ai_client=self.webpackChunkwingrox_ai_client||[]).push([[565],{1565:(e,s,t)=>{t.r(s),t.d(s,{default:()=>u});var a=t(5043),r=t(8417),l=t(579);const i=e=>{let{active:s,children:t,className:a="",...r}=e;return(0,l.jsx)("button",{className:`px-6 py-2 rounded-full font-semibold shadow transition-all text-lg\n        ${s?"bg-cyan-500 text-white":"bg-white text-blue-700 border border-blue-200 hover:bg-blue-50"}\n        ${a}`.trim(),...r,children:t})};var n=t(3216),o=t(2115),d=t(6291),c=t(2811),m=t(6625);const u=()=>{const[e,s]=(0,a.useState)(()=>localStorage.getItem("communityQuestionDraft")||""),[t,u]=(0,a.useState)(()=>localStorage.getItem("communityQuestionDetailsDraft")||"");(0,a.useEffect)(()=>{localStorage.setItem("communityQuestionDraft",e)},[e]),(0,a.useEffect)(()=>{localStorage.setItem("communityQuestionDetailsDraft",t)},[t]);const[x,h]=(0,a.useState)(!1),[g,p]=(0,a.useState)("most-viewed"),[w,f]=(0,a.useState)([]),[b,v]=(0,a.useState)([]),[y,j]=(0,a.useState)({segments:!0,posts:!0}),[N,k]=(0,a.useState)(!1),[C,_]=(0,a.useState)("Career Plateau & Stagnation"),[A,S]=(0,a.useState)({}),[R,$]=(0,a.useState)({}),[q,z]=(0,a.useState)({}),[L,M]=(0,a.useState)({}),[B,P]=(0,a.useState)({}),[D,Q]=(0,a.useState)({}),W=(0,a.useRef)(null),[F,I]=(0,a.useState)(""),[E,V]=(0,a.useState)({page:1,limit:10,hasMore:!0,loading:!1}),[O,G]=(0,a.useState)(null),H=(0,n.Zp)(),{user:K,loading:Y,isAdmin:T}=(0,m.A)();(0,a.useEffect)(()=>{(async()=>{j(e=>({...e,posts:!0}));try{const e=await d.Aq.getPosts({segmentId:C,sort:g,search:F,page:E.page,limit:E.limit});v(e)}catch(e){o.oR.error("Failed to load posts.")}finally{j(e=>({...e,posts:!1}))}})()},[C,g,F,E.page]),(0,a.useEffect)(()=>{(async()=>{j(e=>({...e,segments:!0}));try{const e=await d.Aq.getSegments();f(e)}catch(e){o.oR.error("Failed to load community segments.")}finally{j(e=>({...e,segments:!1}))}})()},[]);return(0,l.jsxs)("div",{className:"flex flex-col space-y-12 pb-16 min-h-screen bg-gray-50 relative overflow-hidden",children:[(0,l.jsx)("section",{className:"relative rounded-xl overflow-hidden mb-8 shadow-lg",children:(0,l.jsx)("div",{className:"bg-gradient-to-r from-blue-900 to-indigo-800 p-8 md:p-12 text-white",children:(0,l.jsxs)("div",{className:"relative z-10 max-w-3xl mx-auto text-center",children:[(0,l.jsx)("h1",{className:"text-4xl md:text-5xl lg:text-6xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-blue-200 to-cyan-400",children:"WinGroX Community"}),(0,l.jsx)("h2",{className:"text-xl md:text-2xl font-semibold mb-5 text-blue-100",children:"Connect, share insights, and grow with others on similar journeys"})]})})}),(0,l.jsx)("div",{className:"w-full flex flex-col items-center py-8 bg-white rounded-2xl shadow-lg mx-auto mt-8",children:(0,l.jsxs)("div",{className:"flex flex-row flex-wrap gap-4 justify-center w-full",children:[w.map(e=>(0,l.jsx)(i,{active:C===e.id,onClick:()=>_(e.id),children:e.name},e.id)),(0,l.jsx)(r.$,{variant:"secondary",size:"md",className:"ml-2",onClick:()=>_(""),disabled:""===C,children:"Clear"})]})}),(0,l.jsx)("div",{className:"p-4 w-full mx-auto",children:(0,l.jsxs)("main",{className:"bg-gradient-to-b from-gray-50 to-blue-50 rounded-xl p-6 shadow-lg w-full",children:[(0,l.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 mb-8 p-4 bg-white rounded-xl shadow",children:[(0,l.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,l.jsx)(r.$,{variant:"most-liked"===g?"primary":"secondary",size:"sm",className:"most-liked"===g?"border-cyan-500":"border-blue-200",onClick:()=>p("most-liked"),children:"Most Liked"}),(0,l.jsx)(r.$,{variant:"most-viewed"===g?"primary":"secondary",size:"sm",className:"most-viewed"===g?"border-cyan-500":"border-blue-200",onClick:()=>p("most-viewed"),children:"Most Viewed"}),(0,l.jsx)(r.$,{variant:"newest"===g?"primary":"secondary",size:"sm",className:"newest"===g?"border-cyan-500":"border-blue-200",onClick:()=>p("newest"),children:"Newest"})]}),(0,l.jsx)("input",{type:"text",className:"w-full md:w-64 px-4 py-2 rounded-full border border-blue-200 focus:outline-none focus:ring-2 focus:ring-cyan-400 text-base",placeholder:"Search posts...",value:F,onChange:e=>I(e.target.value)})]}),(0,l.jsxs)("div",{className:"bg-white rounded-2xl p-8 mb-8 shadow-xl flex flex-col gap-6 w-full mx-auto",style:{width:"100%",maxWidth:"100%",minWidth:"100%"},children:[(0,l.jsx)("h3",{className:"font-extrabold text-2xl mb-2 text-blue-900",children:"Ask Your Question"}),(0,l.jsx)("textarea",{ref:W,className:"w-full p-4 border border-gray-300 rounded-xl mb-4 min-h-[80px] text-lg focus:outline-none focus:ring-2 focus:ring-cyan-400",placeholder:"What's your biggest challenge right now? Our coaches are here to help...",value:e,onChange:e=>s(e.target.value),disabled:N}),(0,l.jsx)("textarea",{className:"w-full p-4 border border-gray-300 rounded-xl mb-4 text-lg focus:outline-none focus:ring-2 focus:ring-cyan-400",placeholder:"Add more details to your question (optional)",value:t,onChange:e=>u(e.target.value),disabled:N}),(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("input",{type:"checkbox",id:"askAnonymous",checked:x,onChange:()=>h(!x),className:"h-5 w-5 accent-cyan-500",disabled:N}),(0,l.jsx)("label",{htmlFor:"askAnonymous",className:"text-base font-medium text-gray-700",children:"Ask anonymously"})]}),(0,l.jsx)(r.$,{variant:"primary",size:"lg",onClick:async()=>{if(e.trim()){if(!K&&!Y)return o.oR.info("Please log in to post a question."),void H("/login",{state:{from:"/grow-with-community"}});k(!0);try{await d.Aq.createPost({author:(null===K||void 0===K?void 0:K.name)||"Anonymous",question:e.trim(),details:t.trim(),segmentId:C,isAnonymous:x,views:0,likes:0,bookmarks:0,comments:0,isActive:!0,isAnswered:!1}),s(""),u(""),localStorage.removeItem("communityQuestionDraft"),localStorage.removeItem("communityQuestionDetailsDraft"),o.oR.success("Question posted successfully!")}catch(a){o.oR.error("Failed to post question.")}finally{k(!1)}}},isLoading:N,disabled:N||""===e.trim(),className:"w-full sm:w-auto",children:"Post Question"})]})]}),(0,l.jsx)("div",{className:"space-y-8",children:y.posts&&1===E.page?(0,l.jsx)("div",{className:"flex justify-center py-8",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):0===b.length?(0,l.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,l.jsx)("p",{className:"mb-4",children:"No posts in this segment yet."}),(0,l.jsx)("p",{children:"Be the first to ask a question!"})]}):b.map(e=>{var s;return(0,l.jsxs)("div",{className:"border-b border-gray-200 pb-6 last:border-b-0",children:[(0,l.jsx)("p",{className:"font-bold text-lg text-blue-900 mb-2 break-words overflow-hidden max-h-16 relative w-full",style:{wordBreak:"break-word",maxWidth:"100%"},children:e.question&&e.question.length>120?(0,l.jsxs)("span",{children:[e.question.slice(0,120),"...",(0,l.jsx)(r.$,{variant:"outline",size:"sm",className:"ml-2",onClick:()=>{var s;return G({type:"title",content:null!==(s=e.question)&&void 0!==s?s:""})},children:"Read More"})]}):e.question}),(0,l.jsx)("p",{className:"text-gray-600 break-words overflow-hidden max-h-24 relative w-full",style:{wordBreak:"break-word",maxWidth:"100%"},children:e.details&&e.details.length>300?(0,l.jsxs)("div",{children:[e.details.slice(0,300),"...",(0,l.jsx)(r.$,{variant:"outline",size:"sm",className:"ml-2",onClick:()=>{var s;return G({type:"question",content:null!==(s=e.details)&&void 0!==s?s:""})},children:"Read More"})]}):e.details}),e.answer&&(0,l.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg my-3",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,l.jsx)("div",{className:"bg-blue-100 text-blue-800 font-bold h-8 w-8 rounded-full flex items-center justify-center text-sm",children:(null===(s=e.answeredBy)||void 0===s?void 0:s.charAt(0))||"C"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium text-sm",children:e.answeredBy}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:e.answererRole})]})]}),(0,l.jsx)("div",{className:"whitespace-pre-wrap text-gray-800 leading-relaxed break-words overflow-hidden max-h-32 relative w-full",style:{wordBreak:"break-word",maxWidth:"100%"},children:e.answer.length>400?(0,l.jsxs)("div",{children:[e.answer.slice(0,400),"...",(0,l.jsx)(r.$,{variant:"outline",size:"sm",className:"ml-2",onClick:()=>{var s;return G({type:"answer",content:null!==(s=e.answer)&&void 0!==s?s:""})},children:"Read More"})]}):e.answer})]}),e.reflection&&(0,l.jsxs)("div",{className:"bg-indigo-50 border-l-4 border-indigo-500 p-4 rounded-r my-4 italic",children:[(0,l.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Key Reflection:"}),e.reflection]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-4 mt-4 pt-4 border-t border-gray-100",children:[(0,l.jsxs)(r.$,{variant:"primary",size:"md",className:"flex items-center gap-2",onClick:()=>(async e=>{try{const s=await d.Aq.likePost(e);v(t=>t.map(t=>t._id===e?{...t,likes:s.likes}:t))}catch(s){console.error(`Error liking post ${e}:`,s)}})(e._id),children:[(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5"})}),(0,l.jsx)("span",{children:e.likes})]}),(0,l.jsxs)(r.$,{variant:"primary",size:"md",className:"flex items-center gap-2",onClick:()=>(async e=>{try{const s=await d.Aq.bookmarkPost(e);v(t=>t.map(t=>t._id===e?{...t,bookmarks:s.bookmarks}:t))}catch(s){console.error(`Error bookmarking post ${e}:`,s)}})(e._id),children:[(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})}),(0,l.jsx)("span",{children:e.bookmarks})]}),(0,l.jsxs)(r.$,{variant:"primary",size:"md",className:"flex items-center gap-2",onClick:()=>(async e=>{R[e]?$(s=>({...s,[e]:!1})):A[e]&&$(s=>({...s,[e]:!0}))})(e._id),children:[(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),(0,l.jsx)("span",{children:e.comments})]}),K&&!e.isAnswered&&(0,l.jsxs)(r.$,{variant:"primary",size:"lg",className:"flex items-center gap-2 ml-auto",onClick:()=>M(s=>({...s,[e._id]:!s[e._id]})),children:[(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),"Coach Reply"]})]}),L[e._id]&&(0,l.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[(0,l.jsx)("h4",{className:"font-medium mb-2",children:"Coach Answer"}),(0,l.jsx)("textarea",{className:"w-full p-3 border border-gray-300 rounded-lg mb-3 min-h-[120px]",placeholder:"Provide your expert guidance and advice...",value:B[e._id]||"",onChange:s=>P(t=>({...t,[e._id]:s.target.value}))}),(0,l.jsx)("h4",{className:"font-medium mb-2",children:"Key Reflection (Optional)"}),(0,l.jsx)("textarea",{className:"w-full p-3 border border-gray-300 rounded-lg mb-3",placeholder:"Add a key reflection or takeaway from this question...",value:D[e._id]||"",onChange:s=>Q(t=>({...t,[e._id]:s.target.value}))}),(0,l.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,l.jsx)(r.$,{variant:"secondary",size:"lg",onClick:()=>M(s=>({...s,[e._id]:!1})),children:"Cancel"}),(0,l.jsx)(r.$,{variant:"primary",size:"lg",onClick:()=>(async e=>{if(B[e]&&""!==B[e].trim())if("user"!==(null===K||void 0===K?void 0:K.role))try{var s;k(!0);const t=await d.Aq.answerPost(e,{answer:B[e].trim(),answeredBy:(null===K||void 0===K?void 0:K.name)||"Coach",answererRole:(null===K||void 0===K?void 0:K.role)||"Coach",answererCoachId:null===K||void 0===K?void 0:K.id,reflection:null===(s=D[e])||void 0===s?void 0:s.trim()});v(s=>s.map(s=>s._id===e?{...s,isAnswered:!0,answer:t.answer,answeredBy:t.answeredBy,answererRole:t.answererRole,reflection:t.reflection}:s)),M(s=>({...s,[e]:!1})),P(s=>({...s,[e]:""})),Q(s=>({...s,[e]:""})),o.oR.success("Your answer has been posted successfully!")}catch(t){console.error(`Error answering post ${e}:`,t),o.oR.error("Failed to submit your answer. Please try again.")}finally{k(!1)}else o.oR.error("Only coaches and admins can provide official answers.")})(e._id),isLoading:N,disabled:!B[e._id]||""===B[e._id].trim()||N,children:"Submit Answer"})]})]}),R[e._id]&&(0,l.jsxs)("div",{className:"mt-4 pl-4 border-l-2 border-gray-200",children:[(0,l.jsx)("h4",{className:"font-medium mb-2",children:"Comments"}),A[e._id]&&A[e._id].length>0?(0,l.jsx)("div",{className:"space-y-3 mb-4",children:A[e._id].map(e=>{return(0,l.jsxs)("div",{className:"bg-gradient-to-b from-white to-blue-50 p-3 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,l.jsx)("div",{className:"flex items-center",children:(0,l.jsx)("span",{className:"font-medium text-sm",children:e.author})}),(0,l.jsx)("span",{className:"text-xs text-gray-500",children:e.createdAt&&(s=e.createdAt,(0,c.A)(new Date(s),{addSuffix:!0}))})]}),(0,l.jsx)("p",{className:"text-gray-800 text-sm",children:e.content})]},e._id);var s})}):(0,l.jsx)("p",{className:"text-gray-500 text-sm mb-3",children:"No comments yet."}),(0,l.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,l.jsx)("input",{type:"text",className:"flex-1 border border-gray-300 rounded-lg p-2 text-sm",placeholder:K?"Add a comment...":"Log in to comment...",value:q[e._id]||"",onChange:s=>z(t=>({...t,[e._id]:s.target.value})),disabled:!K}),(0,l.jsx)(r.$,{variant:"primary",size:"lg",onClick:()=>(async e=>{const s=q[e];if(s&&""!==s.trim()){if(!K&&!Y)return o.oR.info("Please log in to add comments."),void H("/login",{state:{from:"/grow-with-community"}});try{const t=await d.Aq.addComment(e,{author:(null===K||void 0===K?void 0:K.name)||"Guest User",content:s.trim(),isAnonymous:!1,likes:0,isActive:!0});S(s=>({...s,[e]:[...s[e]||[],t]})),z(s=>({...s,[e]:""})),v(s=>s.map(s=>s._id===e?{...s,comments:s.comments+1}:s)),o.oR.success("Comment added successfully.")}catch(t){console.error(`Error adding comment to post ${e}:`,t),o.oR.error("Failed to add comment. Please try again.")}}})(e._id),disabled:!K||!q[e._id]||""===q[e._id].trim(),children:"Post"})]})]})]},e._id)})})]})}),O&&(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60",children:(0,l.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-2xl w-full relative",children:[(0,l.jsx)("button",{className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700 text-2xl font-bold",onClick:()=>G(null),title:"Close",children:"\xd7"}),(0,l.jsxs)("h2",{className:"font-bold text-2xl mb-4 text-blue-900",children:["title"===O.type&&"Full Question Title","question"===O.type&&"Full Question Details","answer"===O.type&&"Full Coach Answer"]}),(0,l.jsx)("div",{className:"whitespace-pre-wrap text-lg text-gray-800 break-words",children:O.content})]})})]})}}}]);
//# sourceMappingURL=565.5ad9b93c.chunk.js.map